"use strict";(globalThis.webpackChunksite=globalThis.webpackChunksite||[]).push([[573],{2353:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>c,frontMatter:()=>s,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"Existing Plugins/Map/Extracting Map Data","title":"Extracting Map Data","description":"This page will walk you through extracting additional Map data for ETS2LA. Please keep in mind that this is an advanced procedure that should only be attempted if you\'re confortable with a terminal and have at least some linux knowledge!","source":"@site/docs/05-Existing Plugins/01-Map/01-Extracting Map Data.md","sourceDirName":"05-Existing Plugins/01-Map","slug":"/Existing Plugins/Map/Extracting Map Data","permalink":"/docs/Existing Plugins/Map/Extracting Map Data","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"mainSidebar","previous":{"title":"TruckSimAPI","permalink":"/docs/Modules/TruckSimAPI"},"next":{"title":"Explanation","permalink":"/docs/Existing Plugins/AR\xa0/Explanation"}}');var o=n(4848),i=n(8453);const s={},r="Extracting Map Data",d={},l=[{value:"1. Download WSL",id:"1-download-wsl",level:3},{value:"2. Prep the WSL instance.",id:"2-prep-the-wsl-instance",level:3},{value:"3. Download and install the extractor.",id:"3-download-and-install-the-extractor",level:3},{value:"4. Extract the data.",id:"4-extract-the-data",level:3},{value:"5. Testing data, creating the config, and publishing.",id:"5-testing-data-creating-the-config-and-publishing",level:3}];function h(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"extracting-map-data",children:"Extracting Map Data"})}),"\n",(0,o.jsxs)(t.p,{children:["This page will walk you through extracting additional Map data for ETS2LA. ",(0,o.jsx)(t.strong,{children:"Please keep in mind that this is an advanced procedure that should only be attempted if you're confortable with a terminal and have at least some linux knowledge!"})]}),"\n",(0,o.jsx)(t.h3,{id:"1-download-wsl",children:"1. Download WSL"}),"\n",(0,o.jsx)(t.p,{children:"The data extractor can only run in a Linux environment. It's recommended to run the extractor inside WSL, as you can still access your Windows game files through it."}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/windows/wsl/install",children:"https://learn.microsoft.com/en-us/windows/wsl/install"})," ",(0,o.jsx)("br",{}),"\r\nWe recommend you download Ubuntu, that's the default distribution."]}),"\n",(0,o.jsx)(t.h3,{id:"2-prep-the-wsl-instance",children:"2. Prep the WSL instance."}),"\n",(0,o.jsxs)(t.p,{children:["By default WSL will try to use your Windows based programs. This means that if you run ",(0,o.jsx)(t.code,{children:"node"})," inside the WSL instance, it will poll your Windows install. That won't work so these commands install node:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"sudo apt update\r\nsudo apt install curl\r\ncurl -o- https://raw.githubusercontent.com/nvm-sh/nvm/master/install.sh | bash\n"})}),"\n",(0,o.jsx)(t.p,{children:"Please open a new terminal now to refresh PATH"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"nvm ls # should show as N/A\r\nnvm install node\r\nnvm ls # should show as stable\n"})}),"\n",(0,o.jsx)(t.p,{children:"The extractor also needs some additional requirements, these can be installed like so:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"sudo apt install make\r\nsudo apt install g++\n"})}),"\n",(0,o.jsx)(t.h3,{id:"3-download-and-install-the-extractor",children:"3. Download and install the extractor."}),"\n",(0,o.jsxs)(t.p,{children:["This step will require git being installed, you should already have it so the following code will clone our maps repo. This repo is a custom fork of ",(0,o.jsx)(t.a,{href:"https://github.com/truckermudgeon/maps",children:"tmudge's"})," version with added mod support."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"cd ~\r\nmkdir maps\r\ncd maps\r\ngit clone --recurse-submodules https://github.com/ETS2LA/maps/ .\n"})}),"\n",(0,o.jsxs)(t.p,{children:["This will clone the repository into ",(0,o.jsx)(t.code,{children:"/home/username/maps"}),", the rest of the commands ",(0,o.jsx)(t.strong,{children:"assume you are in this directory!"})]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"npm i\r\nnpm run build -w packages/clis/parser\n"})}),"\n",(0,o.jsxs)(t.p,{children:["This will first install all node requirements, and then build the parser app. If you hit an error then try to run ",(0,o.jsx)(t.code,{children:"chmod +x ./node_modules/husky/lib/bin.js"})," and then the build command."]}),"\n",(0,o.jsx)(t.h3,{id:"4-extract-the-data",children:"4. Extract the data."}),"\n",(0,o.jsxs)(t.p,{children:["At this point we're ready to actually start extracting data. The command has three major parameters ",(0,o.jsx)(t.code,{children:"-g"})," followed by the ",(0,o.jsx)(t.strong,{children:"path to the game"}),", ",(0,o.jsx)(t.code,{children:"-m"})," followed by the ",(0,o.jsx)(t.strong,{children:"path to the mod folder"})," and ",(0,o.jsx)(t.code,{children:"-o"})," followed by the ",(0,o.jsx)(t.strong,{children:"path to the output."})," Below is an example command you should fill out:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:'mkdir data\r\nnpx parser -g "/mnt/{windows_drive_label}/path/to/the/game/in/your/windows/drive" -m "/mnt/{windows_drive_label}/path/to/the/mods/folder/in/your/windows/drive" -o "/home/{ubuntu_username}/maps/data"\r\nnpx generator graph -m [usa/europe] -o "/home/{ubuntu_username}/maps/data" -i "/home/{ubuntu_username}/maps/data"\n'})}),"\n",(0,o.jsx)(t.p,{children:"Here's an example of how a command should look like:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:'npx parser -g "/mnt/c/Program Files (x86)/Steam/steamapps/common/Euro Truck Simulator 2" -m "/mnt/c/Users/Tumppi066/Documents/Euro Truck Simulator 2/mod" -o "/home/tuomas/maps/data"\n'})}),"\n",(0,o.jsxs)(t.p,{children:["Run the graph command the same way, just remember to change the ",(0,o.jsx)(t.code,{children:"-m"})," parameter to the base game, so that's ",(0,o.jsx)(t.code,{children:"usa"})," or ",(0,o.jsx)(t.code,{children:"europe"}),"."]}),"\n",(0,o.jsx)(t.h3,{id:"5-testing-data-creating-the-config-and-publishing",children:"5. Testing data, creating the config, and publishing."}),"\n",(0,o.jsxs)(t.admonition,{type:"note",children:[(0,o.jsx)(t.p,{children:"This section is a lot of work, if you don't know / want to do it yourself, you can send the data to the developers on Discord, and they'll handle the uploading for you."}),(0,o.jsx)(t.p,{children:"It is recommended to try and learn this though, as the developers have limited time and it might take some time to get the data in \ud83d\udc4d"})]}),"\n",(0,o.jsxs)(t.p,{children:["Before we begin, make sure you are using the base data for your game. So let's say your mods are on ",(0,o.jsx)(t.code,{children:"ETS2 1.55"}),", then you should download that base data first."]}),"\n",(0,o.jsxs)(t.p,{children:["You can then copy everything except ",(0,o.jsx)(t.code,{children:"icons"})," from the data folder to ",(0,o.jsx)(t.code,{children:"app/Plugins/Map/data"}),", this will overwrite the existing data. Note that you can open the Ubuntu file system from file explorer by going to the ",(0,o.jsx)(t.em,{children:"Linux"})," tab in the bottom left."]}),"\n",(0,o.jsxs)(t.p,{children:["Next up you should open the ",(0,o.jsx)(t.code,{children:"config.json"})," file, and edit the values to match. First of all you should change the descriptions, and the credits. You can add more credit categories to the dictionary as you please. Just keep in mind the formatting already there, if the json file is malformed it will not work. You can copy you JSON file to a viewer like ",(0,o.jsx)(t.a,{href:"https://jsonformatter.org/json-viewer",children:"https://jsonformatter.org/json-viewer"})," and it will warn you of any errors."]}),"\n",(0,o.jsxs)(t.p,{children:["To get the ",(0,o.jsx)(t.code,{children:"size"})," variable, you can highlight all the data files in file explorer, right click, and go into properties. There you can see the ",(0,o.jsx)(t.em,{children:"Size"})," parameter and you can copy the value. Please remove the commas, as the value has to be back to back!"]}),"\n",(0,o.jsxs)(t.p,{children:["If you're ready with the rest of the file, you can pack your data to a ",(0,o.jsx)(t.code,{children:".zip"})," file, ",(0,o.jsx)(t.em,{children:"do not include the config.json file, only the data!"})," After packing you can do the same size check for the ",(0,o.jsx)(t.code,{children:"packed_size"})," variable in the config."]}),"\n",(0,o.jsx)(t.p,{children:"At this point you can launch the game and reload the Map plugin. This will load your custom data into the system and you should be able to drive around the map correctly."}),"\n",(0,o.jsxs)(t.p,{children:["You might've noticed the ",(0,o.jsx)(t.code,{children:"offsets"})," array inside the config. This is for manually fixing some roads that are not correctly parsed. If you launch ETS2LA with ",(0,o.jsx)(t.code,{children:"--dev"})," (edit the ",(0,o.jsx)(t.code,{children:"start.bat"})," file and add the argument to the end of the python call like ",(0,o.jsx)(t.code,{children:"python main.py --dev"})," ) you can see a new tab in the Map settings, this tab has the option to enable an internal map."]}),"\n",(0,o.jsxs)(t.p,{children:["If you encounter any offset issues when driving, you can hover over the road in the internal map and click it, this will copy it's name, and you can add it to the ",(0,o.jsx)(t.code,{children:"per_name"})," dictionary. The left side string is the road name, the right side is your custom offset. Once you change the offset you can click the ",(0,o.jsx)(t.code,{children:"Reload Offsets"})," button in the Map settings and check the internal Map for changes. ",(0,o.jsx)(t.em,{children:"Please note that the visualization won't update the road, only the internal map does!"})]}),"\n",(0,o.jsxs)(t.p,{children:["If you're happy with your offsets, you can send the files to any of the developers on Discord, or make a merge request to ",(0,o.jsx)(t.a,{href:"https://gitlab.com/ETS2LA/data",children:"https://gitlab.com/ETS2LA/data"})," directly. Once they are added to the repository anyone can download them from the Map settings \ud83d\udc4d"]})]})}function c(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>r});var a=n(6540);const o={},i=a.createContext(o);function s(e){const t=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),a.createElement(i.Provider,{value:t},e.children)}}}]);